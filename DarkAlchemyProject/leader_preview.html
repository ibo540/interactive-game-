<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HETAIROI - Leader Link (Design Preview)</title>
    <!-- Importing Fancy Fonts: Cinzel Decorative (Headers) & Cormorant Garamond (Body) -->
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
</head>

<body>
    <div class="container">
        <div class="corner tl"></div>
        <div class="corner tr"></div>
        <div class="corner bl"></div>
        <div class="corner br"></div>

        <h1>LEADER</h1>
        <p class="sub-header">Supreme Commander // Allocation Protocol</p>

        <div class="pool-display" id="pool-box">
            <span class="pool-label">TREASURY RESERVES</span>
            <span id="pool-remaining" class="pool-value">100</span>
        </div>

        <div class="allocation-form">
            <!-- SELF -->
            <h3 class="section-title">Personal Reserve (Max 10)</h3>
            <div class="allocation-item">
                <div class="label-row">
                    <span>The Leader (You)</span>
                </div>
                <div class="control-row">
                    <!-- Slider -->
                    <input type="range" id="slider-self" min="0" max="10" value="0"
                        oninput="syncInputs(this, 'num-self'); updatePool()">
                    <!-- Box -->
                    <input type="number" id="num-self" min="0" max="10" value="0"
                        oninput="syncInputs(this, 'slider-self'); updatePool()">
                </div>
            </div>

            <!-- ELITES -->
            <h3 class="section-title">Elite Ministries</h3>

            <div id="elite-container">
                <!-- JS will inject duplicated rows to keep code clean, but for PREVIEW we hardcode 1 to show -->
            </div>

            <!-- Render rest of static preview items -->
            <div class="allocation-item">
                <div class="label-row"><span>Military Command</span></div>
                <div class="control-row">
                    <input type="range" class="elite-slider" min="0" max="100" value="0" id="sld-mil"
                        oninput="syncInputs(this, 'num-mil'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-mil"
                        oninput="syncInputs(this, 'sld-mil'); updatePool()">
                </div>
            </div>
            <div class="allocation-item">
                <div class="label-row"><span>Intelligence Bureau</span></div>
                <div class="control-row">
                    <input type="range" class="elite-slider" min="0" max="100" value="0" id="sld-int"
                        oninput="syncInputs(this, 'num-int'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-int"
                        oninput="syncInputs(this, 'sld-int'); updatePool()">
                </div>
            </div>
            <div class="allocation-item">
                <div class="label-row"><span>Interior Ministry</span></div>
                <div class="control-row">
                    <input type="range" class="elite-slider" min="0" max="100" value="0" id="sld-inr"
                        oninput="syncInputs(this, 'num-inr'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-inr"
                        oninput="syncInputs(this, 'sld-inr'); updatePool()">
                </div>
            </div>
            <div class="allocation-item">
                <div class="label-row"><span>Central Bank</span></div>
                <div class="control-row">
                    <input type="range" class="elite-slider" min="0" max="100" value="0" id="sld-eco"
                        oninput="syncInputs(this, 'num-eco'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-eco"
                        oninput="syncInputs(this, 'sld-eco'); updatePool()">
                </div>
            </div>
            <div class="allocation-item">
                <div class="label-row"><span>State Media</span></div>
                <div class="control-row">
                    <input type="range" class="elite-slider" min="0" max="100" value="0" id="sld-med"
                        oninput="syncInputs(this, 'num-med'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-med"
                        oninput="syncInputs(this, 'sld-med'); updatePool()">
                </div>
            </div>


            <!-- CITIZENS -->
            <h3 class="section-title">Public Classes</h3>

            <div class="allocation-item">
                <div class="label-row"><span>Upper Class</span></div>
                <div class="control-row">
                    <input type="range" class="citizen-slider" min="0" max="100" value="0" id="sld-upp"
                        oninput="syncInputs(this, 'num-upp'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-upp"
                        oninput="syncInputs(this, 'sld-upp'); updatePool()">
                </div>
            </div>
            <div class="allocation-item">
                <div class="label-row"><span>Middle Class</span></div>
                <div class="control-row">
                    <input type="range" class="citizen-slider" min="0" max="100" value="0" id="sld-mid"
                        oninput="syncInputs(this, 'num-mid'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-mid"
                        oninput="syncInputs(this, 'sld-mid'); updatePool()">
                </div>
            </div>
            <div class="allocation-item">
                <div class="label-row"><span>Labor Class</span></div>
                <div class="control-row">
                    <input type="range" class="citizen-slider" min="0" max="100" value="0" id="sld-low"
                        oninput="syncInputs(this, 'num-low'); updatePool()">
                    <input type="number" min="0" max="100" value="0" id="num-low"
                        oninput="syncInputs(this, 'sld-low'); updatePool()">
                </div>
            </div>

            <button class="btn-submit" onclick="submitMockAllocation()">CONFIRM BUDGET</button>
        </div>
    </div>

    <script>
        function syncInputs(source, targetId) {
            const target = document.getElementById(targetId);
            if (target) target.value = source.value;
        }

        let wasOverBudget = false;

        function updatePool() {
            // Calculate total from Number inputs (they are the source of truth if edited)
            const inputs = document.querySelectorAll('input[type="number"]');
            let total = 0;
            inputs.forEach(inp => {
                total += parseInt(inp.value || 0);
            });

            const remaining = 100 - total;
            const el = document.getElementById('pool-remaining');
            const box = document.getElementById('pool-box');

            el.innerText = remaining;

            if (remaining < 0) {
                el.style.color = '#ff3333';
                el.style.textShadow = '0 0 10px #ff3333';
                box.classList.add('error');

                // HAPTIC FEEDBACK
                if (!wasOverBudget) {
                    if (navigator.vibrate) navigator.vibrate(200);
                    // Visual shake effect
                    box.style.animation = 'none';
                    box.offsetHeight; /* trigger reflow */
                    box.style.animation = 'shake 0.5s';
                    wasOverBudget = true;
                }
            } else {
                el.style.color = '#4CAF50';
                el.style.textShadow = '0 0 10px rgba(76, 175, 80, 0.5)';
                box.classList.remove('error');
                wasOverBudget = false;
            }
        }

        function submitMockAllocation() {
            const container = document.querySelector('.container');

            // 1. Show Waiting State
            container.innerHTML = `
                <div style="text-align:center; padding: 40px 0;">
                    <h1 style="font-size:2.5rem; animation: pulse 2s infinite;">AWAITING COUNCIL</h1>
                    <p class="sub-header" style="border:none; margin-bottom:2vh;">Transmitting Orders...</p>
                    <div class="loader"></div>
                    <p style="margin-top:20px; font-style:italic; color:#666;">The Board is voting on your fate.</p>
                </div>
            `;

            // 2. Simulate Delay then ask for Outcome
            setTimeout(() => {
                container.innerHTML = `
                    <div style="text-align:center;">
                        <h1 style="color:#fff;">SIMULATION COMPLETE</h1>
                        <p class="sub-header">Select Outcome to Preview</p>
                        
                        <div style="display:flex; gap:20px; justify-content:center; margin-top:30px;">
                            <button onclick="window.location.href='leader_win_preview.html'" 
                                style="padding:15px 30px; background:#4CAF50; border:1px solid #4CAF50; color:#fff; font-family:'Cinzel'; cursor:pointer; font-weight:bold;">
                                VICTORY
                            </button>
                            <button onclick="window.location.href='leader_loss_preview.html'" 
                                style="padding:15px 30px; background:#8a0e0e; border:1px solid #8a0e0e; color:#fff; font-family:'Cinzel'; cursor:pointer; font-weight:bold;">
                                DEFEAT
                            </button>
                        </div>
                    </div>
                `;
            }, 3000);
        }
    </script>

</body>

</html>